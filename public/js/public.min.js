/*! cc-nyscaa - v1.0.0 - 2018-01-02 */!function(a){"use strict";a(function(){function b(){var b=a("#nyscaa-report-"+d+"-list").val();"undefined"!=typeof b&&""!==b&&(a("#nyscaa-report-wait-"+d).show(),document.location=document.location.href.split("?")[0]+"?geoid="+b)}var c="https://services.communitycommons.org/",d="state",e=function(b,d){a.ajax({type:"get",url:c+"api-report/v1/area/list/NYSCAA-poverty?area_id=0&area_type_id="+b,dataType:"json",contentType:"application/json; charset=utf-8",crossDomain:!0,success:d,error:function(a){console.log(a)}})};a("#nyscaa-report-county-list").length&&(e("county",function(b){a.each(b.area_list,function(b,c){a("#nyscaa-report-county-list").append(a("<option></option>").val(c.id).html(c.name))})}),e("city",function(b){a.each(b.area_list,function(b,c){a("#nyscaa-report-city-list").append(a("<option></option>").val(c.id).html(c.name))})})),a("#nyscaa-report-county-list").on("change",function(){d="county",b()}),a("#nyscaa-report-city-list").on("change",function(){d="city",b()});var f;a(".nyscaa-report-export").on("click",function(){var b="https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&#038;subset=latin,latin-ext",d=function(a){var c="<link type='text/css' rel='stylesheet' href='"+b+"' />";c+="<div style='font-family: Open Sans, Helvetica, Arial, sans-serif; text-align:center; line-height: 250%;'>",c+="<h2>"+a+"</h2>",c+="</div>",f.document.body.innerHTML=c},e=function(a,b){f.resizeTo(a,b),f.moveTo((screen.width-a)/2,(screen.height-b)/2)};"undefined"!=typeof f&&f.location&&f.close(),f=window.open("","newwin","width=500,height=300"),d("Converting to Adobe PDF format. Please wait..."),e(550,400),a("#nyscaa-report-content img").each(function(){a(this).attr("src",a(this).attr("data-lazy-src"))});var g="<!DOCTYPE html><html><head>",h=location.protocol;h+="//"+document.location.hostname+"/",a.each([b,h+"wp-content/themes/twentytwelve/style.css",h+"wp-content/themes/CommonsRetheme/style.css",h+"wp-content/plugins/cc-nyscaa/public/css/public.css"],function(a,b){g+="<link type='text/css' rel='stylesheet' href='"+b+"' />"});var i="nyscaa-report-content",j=a("#"+i).html();j=j.replace(/src=("|')\//g,'src="'+h),g+="</head><body class='custom-font-enabled'><div id='"+i+"'>"+j+"</div></body></html>";var k={content:g,pdf:{file_name:"NYSCAA-PovertyReport",show_pagenumber:!1,is_landscape:!1,page_margin:[0,25,30,25],page_width:800}};window.location.search.indexOf("geoid=county-poverty")!==-1&&(k.pdf.show_pagenumber=!0,k.pdf.page_margin[0]=20);var l="Conversion to PDF failed. Please try again or contact us.";a.ajax({type:"POST",url:c+"api-converter/v1/htm2pdf/content",dataType:"json",contentType:"application/json; charset=utf-8",crossDomain:!0,data:JSON.stringify(k),success:function(a){a?(d("Loading PDF File..."),f.location=a,e(1e3,screen.height)):d(l)},error:function(a){console.log(a),d(l)}})}),a(".nyscaa-report-save").on("click",function(){})})}(jQuery);